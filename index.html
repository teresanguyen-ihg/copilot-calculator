<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Copilot Studio Enterprise Cost Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0078d4 0%, #106ebe 50%, #005a9e 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            padding: 40px;
            width: 100%;
            max-width: 1600px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: start;
        }

        h1 {
            color: #323130;
            font-size: 2.5em;
            margin-bottom: 15px;
            text-align: center;
            grid-column: 1 / -1;
            background: linear-gradient(45deg, #0078d4, #106ebe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }

        .subtitle {
            text-align: center;
            color: #605e5c;
            margin-bottom: 30px;
            grid-column: 1 / -1;
            font-size: 1.1em;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .section-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #323130;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #0078d4;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            color: #323130;
            font-size: 1em;
        }

        input[type="number"] {
            padding: 12px 15px;
            border: 2px solid #edebe9;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
            color: #323130;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);
        }

        select {
            padding: 12px 15px;
            border: 2px solid #edebe9;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            color: #323130;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        select:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);
        }

        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #edebe9;
            outline: none;
            transition: all 0.3s ease;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #0078d4;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            background: #106ebe;
        }

        .percentage-display {
            font-weight: 600;
            color: #0078d4;
            font-size: 1.1em;
            text-align: center;
            margin-top: 5px;
        }

        .chart-container {
            position: relative;
            height: 400px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid #edebe9;
        }

        .summary {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #f3f9ff 0%, #deecff 100%);
            border-radius: 12px;
            padding: 30px;
            border: 2px solid #c7e0f4;
        }

        .summary h3 {
            color: #323130;
            margin-bottom: 20px;
            font-size: 1.4em;
            text-align: center;
        }

        .cost-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .cost-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
            border: 1px solid #edebe9;
        }

        .cost-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .cost-value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .payg-cost { color: #0078d4; }
        .message-pack-cost { color: #8661c5; }
        .copilot365-cost { color: #498205; }
        .hybrid-cost { color: #d13438; }

        .cost-label {
            color: #605e5c;
            font-size: 0.85em;
            line-height: 1.4;
        }

        .info-box {
            background: #fff4ce;
            border: 1px solid #ffb900;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 0.9em;
            color: #323130;
        }

        .department-selector {
            background: #f8f9ff;
            border: 2px solid #c7e0f4;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .department-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .department-btn {
            padding: 10px 15px;
            border: 2px solid #edebe9;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .department-btn:hover {
            border-color: #0078d4;
            background: #f3f9ff;
        }

        .department-btn.active {
            border-color: #0078d4;
            background: #0078d4;
            color: white;
        }

        .strategy-comparison {
            grid-column: 1 / -1;
            margin-top: 20px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .comparison-table th {
            background: #0078d4;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #edebe9;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9ff;
        }

        .best-option {
            background: #dff6dd !important;
            border-left: 4px solid #107c10;
        }

        .usage-insights {
            grid-column: 1 / -1;
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-top: 20px;
        }

        .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .insight-item {
            padding: 15px;
            border-left: 4px solid #0078d4;
            background: #f8f9ff;
            border-radius: 8px;
        }

        .insight-title {
            font-weight: 600;
            color: #323130;
            margin-bottom: 8px;
        }

        .insight-text {
            color: #605e5c;
            font-size: 0.9em;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                padding: 20px;
                gap: 20px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .chart-container {
                height: 300px;
            }

            .cost-breakdown {
                grid-template-columns: 1fr;
            }

            .department-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Microsoft Copilot Studio Enterprise Cost Calculator</h1>
        <p class="subtitle">Strategic licensing decisions based on department profiles and usage patterns</p>
        
        <div class="controls">
            <div class="department-selector">
                <div class="section-title">Quick Department Profiles</div>
                <div class="department-grid">
                    <div class="department-btn" data-profile="custom">Custom</div>
                    <div class="department-btn" data-profile="support">Support</div>
                    <div class="department-btn" data-profile="sales">Sales</div>
                    <div class="department-btn" data-profile="executive">Executive</div>
                    <div class="department-btn" data-profile="hr">HR</div>
                    <div class="department-btn" data-profile="marketing">Marketing</div>
                    <div class="department-btn" data-profile="finance">Finance</div>
                    <div class="department-btn" data-profile="field">Field Service</div>
                </div>
            </div>

            <div class="section-title">Department Configuration</div>
            
            <div class="input-group">
                <label for="totalUsers">Total Department Size:</label>
                <input type="number" id="totalUsers" value="200" min="1" max="10000">
            </div>
            
            <div class="input-group">
                <label for="queriesPerDay">Average Queries per User per Day:</label>
                <input type="number" id="queriesPerDay" value="20" min="1" max="100">
            </div>

            <div class="input-group">
                <label for="dataAccessType">Primary Data Access Pattern:</label>
                <select id="dataAccessType">
                    <option value="sharepoint">SharePoint Documents Only (2 msg/query)</option>
                    <option value="mixed" selected>Mixed Organizational Data (16 msg/query)</option>
                    <option value="advanced">Advanced Graph/Database (24.4 msg/query)</option>
                </select>
            </div>

            <div class="input-group">
                <label for="seasonalMultiplier">Seasonal/Peak Usage Multiplier:</label>
                <select id="seasonalMultiplier">
                    <option value="1" selected>Normal Operations (1x)</option>
                    <option value="2">Moderate Peaks (2x)</option>
                    <option value="3">High Peaks - Tax/Holiday Season (3x)</option>
                    <option value="4">Extreme Peaks (4x)</option>
                </select>
            </div>

            <div class="info-box">
                <strong>Break-Even Point:</strong> Full Copilot licenses become cost-effective at just 1 tenant graph grounding query per day (≈$9.30/month vs $30 license).
            </div>
        </div>
        
        <div class="chart-container">
            <canvas id="costChart"></canvas>
        </div>
        
        <div class="summary">
            <h3>Licensing Strategy Comparison</h3>
            <div class="cost-breakdown">
                <div class="cost-item">
                    <div class="cost-value payg-cost" id="paygCost">$31,680</div>
                    <div class="cost-label">Pay-as-you-go<br><span id="paygDetails">3.17M messages/month</span><br><strong>Annual: <span id="paygAnnual">$380,160</span></strong></div>
                </div>
                <div class="cost-item">
                    <div class="cost-value message-pack-cost" id="messagePackCost">$25,600</div>
                    <div class="cost-label">Message Packs<br><span id="packDetails">128 packs (3.2M capacity)</span><br><strong>Annual: <span id="packAnnual">$307,200</span></strong></div>
                </div>
                <div class="cost-item">
                    <div class="cost-value copilot365-cost" id="copilot365Cost">$6,000</div>
                    <div class="cost-label">Full Copilot Licenses<br><span id="licenseDetails">200 users × $30/month</span><br><strong>Annual: <span id="licenseAnnual">$72,000</span></strong></div>
                </div>
                <div class="cost-item">
                    <div class="cost-value hybrid-cost" id="hybridCost">$8,742</div>
                    <div class="cost-label">Hybrid Strategy<br><span id="hybridDetails">30% licenses, 70% PAYG</span><br><strong>Annual: <span id="hybridAnnual">$104,904</span></strong></div>
                </div>
            </div>
        </div>

        <div class="strategy-comparison">
            <h3 class="section-title">Annual Cost Analysis</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Strategy</th>
                        <th>Monthly Cost</th>
                        <th>Annual Cost</th>
                        <th>Cost per User</th>
                        <th>Best For</th>
                    </tr>
                </thead>
                <tbody id="comparisonTableBody">
                    <!-- Table rows will be populated by JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="usage-insights">
            <h3 class="section-title">Strategic Insights & Recommendations</h3>
            <div class="insight-grid">
                <div class="insight-item">
                    <div class="insight-title">Department Profile</div>
                    <div class="insight-text" id="departmentInsight">Customer support teams typically benefit from pay-as-you-go for knowledge access.</div>
                </div>
                <div class="insight-item">
                    <div class="insight-title">Usage Pattern</div>
                    <div class="insight-text" id="usageInsight">With mixed organizational data access, consider hybrid approach.</div>
                </div>
                <div class="insight-item">
                    <div class="insight-title">Cost Optimization</div>
                    <div class="insight-text" id="costInsight">Message packs provide savings at your usage level.</div>
                </div>
                <div class="insight-item">
                    <div class="insight-title">Break-Even Analysis</div>
                    <div class="insight-text" id="breakEvenInsight">Full licenses become cost-effective with frequent organizational data access.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Department profiles from the framework
        const departmentProfiles = {
            support: { users: 200, queries: 20, dataType: 'mixed', description: 'Customer support teams need knowledge access, limited document creation' },
            sales: { users: 50, queries: 15, dataType: 'advanced', description: 'Heavy use of Word, PowerPoint, Excel for proposals and analysis' },
            executive: { users: 20, queries: 10, dataType: 'advanced', description: 'Strategic document creation, comprehensive AI assistance' },
            hr: { users: 30, queries: 15, dataType: 'sharepoint', description: 'Primarily answering policy questions, limited document creation' },
            marketing: { users: 40, queries: 25, dataType: 'advanced', description: 'Content creation across multiple Microsoft apps' },
            finance: { users: 80, queries: 18, dataType: 'mixed', description: 'Mixed approach - analysts get full licenses, clerks use PAYG' },
            field: { users: 150, queries: 12, dataType: 'sharepoint', description: 'Mobile workers needing quick knowledge access' }
        };

        // Message multipliers based on data access type
        const messageMultipliers = {
            sharepoint: 2,    // SharePoint documents only
            mixed: 16,        // 50% graph grounding
            advanced: 24.4    // 80% graph grounding
        };

        // Initialize chart
        const ctx = document.getElementById('costChart').getContext('2d');
        let chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Pay-as-you-go', 'Message Packs', 'Full Licenses', 'Hybrid Strategy'],
                datasets: [{
                    label: 'Monthly Cost ($)',
                    data: [31680, 25600, 6000, 8742],
                    backgroundColor: [
                        'rgba(0, 120, 212, 0.8)',
                        'rgba(134, 97, 197, 0.8)',
                        'rgba(73, 130, 5, 0.8)',
                        'rgba(209, 52, 56, 0.8)'
                    ],
                    borderColor: [
                        'rgba(0, 120, 212, 1)',
                        'rgba(134, 97, 197, 1)',
                        'rgba(73, 130, 5, 1)',
                        'rgba(209, 52, 56, 1)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Monthly Cost: $${context.parsed.y.toLocaleString()}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + value.toLocaleString();
                            }
                        }
                    }
                }
            }
        });

        // Get input elements
        const totalUsersInput = document.getElementById('totalUsers');
        const queriesPerDayInput = document.getElementById('queriesPerDay');
        const dataAccessTypeSelect = document.getElementById('dataAccessType');
        const seasonalMultiplierSelect = document.getElementById('seasonalMultiplier');

        // Department profile buttons
        const departmentBtns = document.querySelectorAll('.department-btn');
        departmentBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                departmentBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const profile = btn.dataset.profile;
                if (profile !== 'custom' && departmentProfiles[profile]) {
                    const dept = departmentProfiles[profile];
                    totalUsersInput.value = dept.users;
                    queriesPerDayInput.value = dept.queries;
                    dataAccessTypeSelect.value = dept.dataType;
                    updateCalculations();
                }
            });
        });

        // Set initial active button
        document.querySelector('[data-profile="custom"]').classList.add('active');

        function updateCalculations() {
            const totalUsers = parseInt(totalUsersInput.value) || 0;
            const queriesPerDay = parseInt(queriesPerDayInput.value) || 0;
            const dataAccessType = dataAccessTypeSelect.value;
            const seasonalMultiplier = parseFloat(seasonalMultiplierSelect.value) || 1;
            
            // Calculate monthly messages
            const messagesPerQuery = messageMultipliers[dataAccessType];
            const workingDays = 22;
            const baseMonthlyMessages = totalUsers * queriesPerDay * workingDays * messagesPerQuery;
            const adjustedMessages = baseMonthlyMessages * seasonalMultiplier;
            
            // Strategy 1: Pay-as-you-go ($0.01 per message)
            const paygMonthlyCost = adjustedMessages * 0.01;
            
            // Strategy 2: Message Packs ($200 per 25,000 messages)
            const packsNeeded = Math.ceil(adjustedMessages / 25000);
            const messagePackCost = packsNeeded * 200;
            
            // Strategy 3: Full Copilot Licenses ($30 per user)
            const fullLicenseCost = totalUsers * 30;
            
            // Strategy 4: Hybrid (30% full licenses, 70% PAYG for mixed departments)
            const hybridLicenseUsers = Math.round(totalUsers * 0.3);
            const hybridPaygUsers = totalUsers - hybridLicenseUsers;
            const hybridLicenseCost = hybridLicenseUsers * 30;
            const hybridPaygMessages = hybridPaygUsers * queriesPerDay * workingDays * messagesPerQuery * seasonalMultiplier;
            const hybridPaygCost = hybridPaygMessages * 0.01;
            const hybridTotalCost = hybridLicenseCost + hybridPaygCost;
            
            // Update displays
            document.getElementById('paygCost').textContent = `${paygMonthlyCost.toLocaleString()}`;
            document.getElementById('paygDetails').textContent = `${(adjustedMessages/1000000).toFixed(2)}M messages/month`;
            document.getElementById('paygAnnual').textContent = `${(paygMonthlyCost * 12).toLocaleString()}`;
            
            document.getElementById('messagePackCost').textContent = `${messagePackCost.toLocaleString()}`;
            document.getElementById('packDetails').textContent = `${packsNeeded} packs (${(packsNeeded * 25000/1000000).toFixed(1)}M capacity)`;
            document.getElementById('packAnnual').textContent = `${(messagePackCost * 12).toLocaleString()}`;
            
            document.getElementById('copilot365Cost').textContent = `${fullLicenseCost.toLocaleString()}`;
            document.getElementById('licenseDetails').textContent = `${totalUsers} users × $30/month`;
            document.getElementById('licenseAnnual').textContent = `${(fullLicenseCost * 12).toLocaleString()}`;
            
            document.getElementById('hybridCost').textContent = `${hybridTotalCost.toLocaleString()}`;
            document.getElementById('hybridDetails').textContent = `${hybridLicenseUsers} licenses, ${hybridPaygUsers} PAYG`;
            document.getElementById('hybridAnnual').textContent = `${(hybridTotalCost * 12).toLocaleString()}`;
            
            // Update chart
            chart.data.datasets[0].data = [paygMonthlyCost, messagePackCost, fullLicenseCost, hybridTotalCost];
            chart.update('animate');
            
            // Update comparison table
            updateComparisonTable(paygMonthlyCost, messagePackCost, fullLicenseCost, hybridTotalCost, totalUsers);
            
            // Update insights
            updateInsights(totalUsers, queriesPerDay, dataAccessType, adjustedMessages, paygMonthlyCost, fullLicenseCost);
        }

        function updateComparisonTable(payg, packs, licenses, hybrid, users) {
            const strategies = [
                { name: 'Pay-as-you-go', monthly: payg, bestFor: 'Variable usage, simple knowledge access' },
                { name: 'Message Packs', monthly: packs, bestFor: 'Predictable high usage, cost savings' },
                { name: 'Full Copilot Licenses', monthly: licenses, bestFor: 'Heavy Microsoft app users, advanced features' },
                { name: 'Hybrid Strategy', monthly: hybrid, bestFor: 'Mixed department roles and usage patterns' }
            ];
            
            // Find the best option (lowest cost)
            const minCost = Math.min(...strategies.map(s => s.monthly));
            
            const tableBody = document.getElementById('comparisonTableBody');
            tableBody.innerHTML = '';
            
            strategies.forEach(strategy => {
                const row = document.createElement('tr');
                if (strategy.monthly === minCost) {
                    row.classList.add('best-option');
                }
                
                row.innerHTML = `
                    <td><strong>${strategy.name}</strong></td>
                    <td>$${strategy.monthly.toLocaleString()}</td>
                    <td>$${(strategy.monthly * 12).toLocaleString()}</td>
                    <td>$${(strategy.monthly / users).toFixed(2)}</td>
                    <td>${strategy.bestFor}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        function updateInsights(users, queries, dataType, messages, paygCost, licenseCost) {
            const dataTypeDescriptions = {
                sharepoint: 'SharePoint document libraries provide cost-effective knowledge access',
                mixed: 'Mixed organizational data access with moderate Graph usage',
                advanced: 'Advanced Graph capabilities with database and semantic search'
            };
            
            // Department insight
            let deptInsight = '';
            if (users < 100) {
                deptInsight = 'Small department - focus on cost-effective knowledge access and targeted licensing.';
            } else if (users < 300) {
                deptInsight = 'Medium department - hybrid strategies often provide optimal cost-benefit balance.';
            } else {
                deptInsight = 'Large department - full licenses typically provide better value at scale with organizational data.';
            }
            
            // Usage insight
            const usageInsight = dataTypeDescriptions[dataType] + `. ${queries} queries per day indicates ${queries > 25 ? 'high' : queries > 15 ? 'moderate' : 'light'} usage patterns.`;
            
            // Cost insight
            let costInsight = '';
            const costDiff = Math.abs(paygCost - licenseCost);
            if (licenseCost < paygCost * 0.5) {
                costInsight = 'Full licenses provide significant savings and comprehensive Microsoft 365 AI capabilities.';
            } else if (Math.abs(licenseCost - paygCost) < paygCost * 0.1) {
                costInsight = 'Costs are very close - choose based on feature needs rather than price alone.';
            } else {
                costInsight = 'Pay-as-you-go or message packs provide better cost control for your usage pattern.';
            }
            
            // Break-even insight
            const dailyBreakEven = dataType === 'sharepoint' ? 15 : dataType === 'mixed' ? 2 : 1;
            const breakEvenInsight = `Break-even point is approximately ${dailyBreakEven} ${dataType === 'sharepoint' ? 'document' : 'organizational data'} queries per user per day.`;
            
            document.getElementById('departmentInsight').textContent = deptInsight;
            document.getElementById('usageInsight').textContent = usageInsight;
            document.getElementById('costInsight').textContent = costInsight;
            document.getElementById('breakEvenInsight').textContent = breakEvenInsight;
        }

        // Add event listeners
        totalUsersInput.addEventListener('input', updateCalculations);
        queriesPerDayInput.addEventListener('input', updateCalculations);
        dataAccessTypeSelect.addEventListener('change', updateCalculations);
        seasonalMultiplierSelect.addEventListener('change', updateCalculations);

        // Initial calculation
        updateCalculations();
    </script>
</body>
</html>
